const dlt = require('../dl-tar');
const fs = require('fs');

const dest = process.argv[2] || 'dlt-race';

const o = dlt('https://github.com/purescript/purescript/releases/download/v0.15.6/linux64.tar.gz', `/tmp/${dest}`, {
  filter: f => f.endsWith('purs')
});
o.subscribe({
  complete() {
    try {
      fs.unlinkSync(`/tmp/${dest}/purs`);
    } catch (e) {
      console.error(e);
      throw e;
    }
  }
});
